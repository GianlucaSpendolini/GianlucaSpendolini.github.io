<!DOCTYPE html>

<html lang="it" xmlns="http://www.w3.org/1999/xhtml">

<head>

    <title></title>
    
</head>

<body>

    <header></header>

    <hr />

    <main>

        <div class="matcher-container">

            <p>
                Numero di corrispondenze trovate: <span id="corr">0</span>.
            </p>

            <textarea id="pattern" placeholder="Inserire il pattern desiderato (in caso di regex non mettere / ad inizio e fine pattern)"></textarea>

            <textarea id="text_to_search" placeholder="Inserire il testo in cui si vogliono cercare le corrispondenze"></textarea>

            <div class="checkbox-container">
                <div>
                    <input type="checkbox" id="is-regex" />
                    RegEx
                </div>
                <div>
                    <input type="checkbox" id="to-replace" />
                    Sostituire
                </div>
            </div>

            <textarea id="replacement" placeholder="Inserire il testo che si vuole inserire ad ogni corrispondenza."></textarea>

            <div>
                <code id="result"></code>
            </div>

        </div>

        <p>

            ...

        </p>
        
    </main>

    <hr />

    <footer></footer>

    <!-- File JavaScript generico -->
    <script src="./Static/javascript/scripts.js" type="module"></script>
    
    <script type="module">

        import {
            UserText
        } from 'https://GianlucaSpendolini.github.io/Static/javascript/util_class.js';


        // Prendo i campi
        let correspondence_field = document.getElementById('corr');
        let pattern_field = document.getElementById('pattern');
        let text_to_search_field = document.getElementById('text_to_search');
        let is_regex_field = document.getElementById('is-regex');
        let to_replace_field = document.getElementById('to-replace');
        let replacement_field = document.getElementById('replacement');
        let result_field = document.getElementById('result');

        // Funzione per elaborare il testo ed inserirlo nel div
        let search_pattern = function() {

            // Prendo i dati
            let pattern = pattern_field.value;
            let text_to_search = text_to_search_field.value;
            let is_regex = is_regex_field.checked;
            let to_replace = to_replace_field.checked;
            let replacement = replacement_field?.value;

            // Creo l'istanza
            let text = new UserText(text_to_search);

            // Cerco il pattern
            return text.find(pattern, is_regex);

        }

        // Aggiungo gli eventi ai campi
        pattern.addEventListener('input', () => {

            console.log(
                pattern.value,
                text,
                text.find(pattern.value, input_checkbox.checked)
            );

            // Eseguo la ricerca
            let find_pattern = search_pattern();

            // Inserisco il risultato unito
            result_field.innerText = find_pattern.join(' ');

            // Dico quante corrispondenze ho trovato
            correspondence_field.innerText = find_pattern.length;

        });

    </script>
</body>

</html>