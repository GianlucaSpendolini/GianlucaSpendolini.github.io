<!DOCTYPE html>

<html lang="it" xmlns="http://www.w3.org/1999/xhtml">

<head>

    <title></title>
    
</head>

<body>

    <header></header>

    <hr />

    <main>

        <div class="checker-container">

            <div>
                <label>
                    Livello di sicurezza
                    <meter id="security-level"></meter>
                </label>

                <input id="password-field" placeholder="Inserisci la password" type="password" />
            </div>

            <div class="checkbox-container">
                Principali
                <ul>
                    <li>
                        <input class="fake-checkbox" disabled id="lowercase-check" type="checkbox" />
                        <label for="uppercase-check">Lettere minuscole</label>
                    </li>
                    <li>
                        <input class="fake-checkbox" disabled id="uppercase-check" type="checkbox" />
                        <label for="uppercase-check">Lettere maiuscole</label>
                    </li>
                    <li>
                        <input class="fake-checkbox" disabled id="numbers-check" type="checkbox" />
                        <label for="uppercase-check">Numeri</label>
                    </li>
                    <li>
                        <input class="fake-checkbox" disabled id="symbols-check" type="checkbox" />
                        <label for="symbols-check">Simboli (. : ; ! ...)</label>
                    </li>
                </ul>

                Secondari
                <ul>
                    <li>
                        <input class="fake-checkbox" disabled id="charsnumber-check" type="checkbox" />
                        <label for="charsnumber-check">Lunghezza di caratteri</label>
                    </li>
                </ul>
            </div>

        </div>

        <p>
            
            ...

        </p>
        
    </main>

    <hr />

    <footer></footer>

    <!-- File JavaScript generico -->
    <script src="./../Static/javascript/scripts.js" type="module"></script>
    
    <script type="module">
        
        // Prendo le variabili
        let security_level = document.getElementById('security-level');
        let password_field = document.getElementById('password-field');
        let lowercase_check = document.getElementById('lowercase-check');
        let uppercase_check = document.getElementById('uppercase-check');
        let numbers_check = document.getElementById('numbers-check');
        let symbols_check = document.getElementById('symbols-check');
        let charsnumber_check = document.getElementById('charsnumber-check');

        // Calcolo il numero di check che ho -> li moltiplico per 5 -> ogni check vale 5 -> somma = max
        let checkboxes = document.querySelectorAll('input[type=checkbox]');
        // Prendo il numero totale dei checkbox
        let check_number = checkboxes.length;
        // Imposto i valori del meter ->  min="0" max="100" low="30" high="70" optimum="100" value="65"
        security_level.max = check_number * 5;
        security_level.high = security_level.max * (70 / 100);
        security_level.low = security_level.max * (30 / 100);
        security_level.min = 0;
        security_level.optimum = security_level.max;
        security_level.value = 0;
        // Per ogni checkbox -> appena cambia -> se check += 5 || -=5
        console.log(checkboxes);
        checkboxes.forEach( checkbox => {
            checkbox.addEventListener('change', () => {
                // Assicura che parta da 0 se il campo è vuoto o non numerico
                let currentValue = parseInt(security_level.value) || 0;
                if (checkbox.checked) {
                    security_level.value = currentValue + 5;
                } else {
                    security_level.value = currentValue - 5;
                }
            });
        });
        
        // Ogni volta che inserisco qualcosa -> faccio il controllo
        password_field.addEventListener('input', () => {
            
            // Prendo la password inserita
            let password = password_field.value;

            /*
                Controlli principali
            */
            // Controllo se contiene lettere minuscole
            if (password.match(/[a-z]+/g)) {
                if (!lowercase_check.checked) {
                    lowercase_check.checked = true;
                }
            } else {
                lowercase_check.checked = false;
            }
            // Controllo se contiene lettere maiuscole
            if (password.match(/[A-Z]+/g)) {
                if (!uppercase_check.checked) {
                    uppercase_check.checked = true;
                }
            } else {
                uppercase_check.checked = false;
            }
            // Controllo se contiene numeri
            if (password.match(/[0-9]+/g)) {
                if (!numbers_check.checked) {
                    numbers_check.checked = true;
                }
            } else {
                numbers_check.checked = false;
            }
            // Controllo se contiene simboli
            if (password.match(/[^a-zA-Z0-9]+/g)) {
                if (!symbols_check.checked) {
                    symbols_check.checked = true;
                }
            } else {
                symbols_check.checked = false;
            }

            /*
                Controlli secondari
            */
            // Controllo se lunghezza è di almeno 8 caratteri
            if (password.match(/.{8,}/g)) {
                if (!charsnumber_check.checked) {
                    charsnumber_check.checked = true;
                }
            } else {
                charsnumber_check.checked = false;
            }

        });

    </script>
</body>

</html>